#!/bin/bash

#HALP Merge master into all PRs and carrion.

set -e

. git_functions

prefix=$(githubuser)-

function mergeone {
    git checkout $1
    local parent=$(pb)
    if false; then
        git rebase $parent # TODO: Ideally do this to carrion branches.
    else
        git merge --no-edit $parent
    fi
}

function mergethem {
    for b in $(publicbranches); do
        [[ $b != $prefix* ]] || mergeone $b
    done
    for b in $(allbranches); do
        [[ $b != carrion-* && $b != controversial-* ]] || mergeone $b
    done
}

nicely mergethem
